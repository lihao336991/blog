## 第21题——javascript的垃圾回收机制

javascript具有垃圾回收机制，垃圾回收器会以固定时间间隔周期性地执行。javascript的垃圾回收主要依赖引用的概念，在内存管理环境中，一个对象如果有访问另一个对象的权限，我们称为一个对象引用另一个对象。

javascript的垃圾回收主要有两种算法：引用计数和标记清除。

#### 引用计数法

声明一个变量并将一个引用类型的值赋值给这个变量，则这个引用类型值的引用次数就加1，一个引用类型值的引用数等于引用该值的变量数。
垃圾收集器会周期性地释放掉引用数为0的引用值所占的内存。

限制： 无法处理循环引用。当两个值互相引用，并且没有任何外部变量引用它们时，由于每一个值的引用数都不为0，所以不会被清除。

#### 标记清除法

垃圾收集器运行的时候会给内存中的所有变量加上标记，定期从根对象（全局对象）开始查找引用，去掉环境中的变量以及被环境中变量引用的变量的标记，剩余带标记的被视为待清除的变量，由垃圾收集器销毁并释放内存空间。

目前所有现代浏览器都使用的标记清除法。

#### 关于内存泄露

容易造成内存泄露的几种场景：

1、意外的全局变量

原因：全局变量始终不会被回收

解决：使用严格模式，避免滥用全局变量。

2、闭包引起的内存泄露

原因：活动对象被引用，使闭包内的变量始终不被释放

解决：将活动变量赋值为null

3、未清理的DOM元素的引用

原因：虽然DOM被删除了，但是在对象中还存在对DOM元素的引用

解决：将对象赋值为null

4、未清理的定时器

原因：定时器内部实现闭包

解决：将定时器赋值为null

